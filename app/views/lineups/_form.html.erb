<%= form_with(model: lineup, local: true, class: 'space-y-6') do |f| %>
  <div>
    <%= f.label :game_date, '試合日', class: 'block text-sm font-medium text-gray-700' %>
    <%= f.date_field :game_date, class: 'mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500' %>
  </div>

  <div>
    <%= f.label :opponent, '対戦相手', class: 'block text-sm font-medium text-gray-700' %>
    <%= f.text_field :opponent, class: 'mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500' %>
  </div>

  <div>
    <%= f.label :result, '結果', class: 'block text-sm font-medium text-gray-700' %>
    <%= f.text_field :result, class: 'mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500', placeholder: '勝利・敗北など' %>
  </div>

  <div>
    <%= f.label :score, 'スコア', class: 'block text-sm font-medium text-gray-700' %>
    <%= f.text_field :score, class: 'mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500', placeholder: '例: 5-3' %>
  </div>

  <hr class="my-6">
  <h2 class="text-xl font-semibold mb-2">スタメン入力</h2>
  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
    <% (1..9).each do |order| %>
      <% lp = lineup.lineup_players.detect { |lpl| lpl.batting_order.to_i == order } || lineup.lineup_players.build(batting_order: order) %>
      <div>
        <%= hidden_field_tag "lineup[lineup_players_attributes][#{order}][id]", lp.id if lp.persisted? %>
        <%= hidden_field_tag "lineup[lineup_players_attributes][#{order}][batting_order]", order %>
        <label class="block text-sm font-medium text-gray-700 mb-1"><%= order %>番</label>
        <%= select_tag "lineup[lineup_players_attributes][#{order}][player_id]",
            options_from_collection_for_select(players || @players, :id, :name, lp.player_id),
            prompt: '選手を選択',
            class: 'block w-full mt-1 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500' %>
        <%= text_field_tag "lineup[lineup_players_attributes][#{order}][position]",
            lp.position,
            class: 'mt-2 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500',
            placeholder: '守備位置' %>
      </div>
    <% end %>
  </div>

  <div class="flex justify-between mt-6">
    <%= link_to '戻る', lineups_path, class: 'px-4 py-2 border rounded hover:bg-gray-50' %>
    <%= f.submit class: 'px-4 py-2 bg-black text-white rounded hover:bg-gray-800' %>
  </div>
<% end %>